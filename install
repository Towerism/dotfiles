#!/bin/bash
# -*- mode: shell-script -*-

set -e

DIR=$(dirname $(realpath "$0"))
OPT="-d $DIR"


which stow >/dev/null 2>&1 || { echo "Unable to automatically install dotfiles: stow was not found"; exit 1; }

MODULES=$(cat $DIR/modules)

echo "Stowing modules:"
for module in $MODULES; do
    printf "  $module... "
    stow $OPT $module
    echo "done"
done

printf "Ensuring Spacemacs is initialized... "
cd "$DIR/"
git submodule init
git submodule update
printf "done\n"

printf "Ensuring theme is configured... "
# configure theme if it has not been configured
if [[ ! -a "$HOME/.cache/wal/wal" ]]; then
    printf "\n"
    ~/.scripts/load-theme ~/.wallpapers/elias-forest-landscape-scenery-tx-2560x1440.jpg
fi
printf "done\n"

