# -*- mode: snippet -*-
#name : root
#key : root
#contributor : Martin
# --
cmake_minimum_required(VERSION 3.0.2 FATAL_ERROR)

option(${1:TESTING} "Enable testing" OFF)

set(CMAKE_MODULE_PATH ${CMAKE_SOURCE_DIR}/cmake)

set(CMAKE_CXX_FLAGS "-std=${2:c++14} ${CMAKE_CXX_FLAGS} -Wall -Wextra -Wpedantic")

include_directories(.)

add_subdirectory(${3:solver})

add_executable(${4:count-sheep} main.cc)

set(MAIN_LIBS $3)
target_link_libraries($4 ${MAIN_LIBS})

if (${TESTING})
  enable_testing()
  add_subdirectory(test EXCLUDE_FROM_ALL)
  add_custom_target(build-tests)

  add_test(NAME unit COMMAND $<TARGET_FILE:unit-tests>)
  add_dependencies(build-tests unit-tests)
endif()
